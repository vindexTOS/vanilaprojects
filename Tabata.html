<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <style>
    body {
      padding: 0;
      margin: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgb(31, 31, 31);
    }
    .mainDiv {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 200px;
    }
    .outCircleDiv {
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgb(0, 196, 98);
      background: linear-gradient(
        176deg,
        rgba(0, 196, 98, 1) 0%,
        rgba(0, 255, 188, 1) 55%
      );
      width: 500px;
      height: 500px;
      border-radius: 50%;
    }
    .innerCircleDiv {
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgb(242, 199, 2);
      background: linear-gradient(
        180deg,
        rgba(242, 199, 2, 1) 0%,
        rgba(238, 72, 84, 1) 39%,
        rgba(237, 18, 118, 1) 64%
      );
      width: 450px;
      height: 450px;
      border-radius: 50%;
    }
    .innerDivWrapper {
      border-radius: 50%;
      width: 460px;
      height: 460px;
      background-color: black;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .timerRunTimeDiv {
      border-radius: 50%;
      width: 420px;
      height: 420px;
      background-color: black;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #time {
      color: white;
      font-size: 12rem;
      font-weight: bolder;
    }
    .btn-wrapper {
    }
    .rounds {
      display: flex;
      align-items: center;
      flex-direction: column;
      justify-content: center;
    }
    .seconds {
      color: white;
    }
    .setTime {
      display: flex;
      gap: 20px;
    }
    .cycle-div {
      visibility: hidden;
    }
  </style>
  <body>
    <div class="mainDiv">
      <!-- Circle  START-->
      <div class="outCircleDiv">
        <div class="innerDivWrapper">
          <div class="innerCircleDiv">
            <div class="timerRunTimeDiv">
              <span id="time">20</span>
            </div>
          </div>
        </div>
      </div>
      <!-- Circle END-->
      <div class="btn-wrapper">
        <div class="rounds">
          <label style="color: white;">
            Rounds
            <span class="roundCount">1</span>
          </label>
          <input type="range" id="round" max="10" min="1" />
        </div>
        <div class="rounds">
          <label style="color: white;">
            Cycles
            <span class="cycleCount">1</span>
          </label>
          <input type="range" id="cycles" max="10" min="1" />
        </div>
        <!-- time -->
        <div class="setTime">
          <div class="seconds">
            <h1>Work Time</h1>
            <div>
              <button id="increment">+</button>
              <span id="setTimer">00</span>
              <button id="decrement">-</button>
            </div>
          </div>
          <div class="seconds">
            <h1>Rest Time</h1>
            <div>
              <button id="incrementRest">+</button>
              <span id="setTimerRest">00</span>
              <button id="decrementRest">-</button>
            </div>
          </div>
          <div class="seconds cycle-div">
            <h1>Cycle Rest Time</h1>
            <div>
              <button id="incrementCycle">+</button>
              <span id="setTimerCycle">00</span>
              <button id="decrementCycle">-</button>
            </div>
          </div>
        </div>
        <!--  -->
        <button id="start">START</button>
      </div>
    </div>
    <script>
      const start = document.querySelector('#start')
      const increment = document.querySelector('#increment')
      const decrement = document.querySelector('#decrement')
      const cycle = document.querySelector('#cycles')
      const rounds = document.querySelector('#round')
      const setTimer = document.querySelector('#setTimer')
      const screenTime = document.querySelector('#time')
      const roundSpan = document.querySelector('.roundCount')
      const cycleSpan = document.querySelector('.cycleCount')
      const restIncrement = document.querySelector('#incrementRest')
      const restDecrement = document.querySelector('#decrementRest')
      const setTimeRest = document.querySelector('#setTimerRest')
      const incrementCycle = document.querySelector('#incrementCycle')
      const decrementCycle = document.querySelector('#decrementCycle')
      const setTimeCycle = document.querySelector('#setTimerCycle')
      const cyclingDiv = document.querySelector('.cycle-div')
      let time = 0
      let restTime = 0
      let roundCount = 1
      let roundCounterStore = 0

      let cycleCount = 1
      let cycleCountStore = 0
      let roundedTime = 0
      let rounderRestTime = 0
      let cycleTime = 0
      //   range
      rounds.addEventListener('change', (e) => {
        roundCount = Number(e.target.value)
        roundCounterStore = Number(e.target.value)
        roundSpan.innerText = e.target.value
      })
      cycle.addEventListener('change', (e) => {
        cycleCount = Number(e.target.value)
        cycleCountStore = Number(e.target.value)
        cycleSpan.innerText = e.target.value
        cyclingDiv.style.visibility = cycleCount > 1 ? 'visible' : 'hidden'
      })
      //   range
      // cycles
      function cycleSpinning(type, classList) {
        if (type === 'increment') {
          if (cycleTime < 60) {
            cycleTime += 10

            classList.innerText = +cycleTime
          }
        }
        if (type === 'decrese') {
          if (cycleTime > 0) {
            cycleTime -= 10

            classList.innerText = cycleTime
          } else {
            cycleTime = 0

            classList.innerText = 0
          }
        }
      }
      //   Work Time Function
      function incrementDecrement(type, classList) {
        if (type === 'increment') {
          if (time < 60) {
            time += 10
            roundedTime += 10
            classList.innerText = +time
          }
        }
        if (type === 'decrese') {
          if (time > 0) {
            time -= 10
            roundedTime -= 10
            classList.innerText = time
          } else {
            time = 0
            roundedTime = 0
            classList.innerText = 0
          }
        }
      }

      function incrementDecrementRest(type, classList) {
        if (type === 'incrementRest') {
          if (restTime < 60) {
            restTime += 10
            rounderRestTime += 10

            classList.innerText = +restTime
          }
        }
        if (type === 'decreseRest') {
          if (restTime > 0) {
            restTime -= 10
            rounderRestTime -= 10
            classList.innerText = restTime
          } else {
            restTime = 0
            rounderRestTime = 0
            classList.innerText = 0
          }
        }
      }

      // increment decrement cycle time
      incrementCycle.addEventListener('click', () =>
        cycleSpinning('increment', setTimeCycle),
      )
      decrementCycle.addEventListener('click', () =>
        cycleSpinning('decrese', setTimeCycle),
      )
      //    increment work

      increment.addEventListener('click', () =>
        incrementDecrement('increment', setTimer),
      )
      decrement.addEventListener('click', () =>
        incrementDecrement('decrese', setTimer),
      )
      //    increment work
      // increment REst
      restIncrement.addEventListener('click', () =>
        incrementDecrementRest('incrementRest', setTimeRest),
      )
      restDecrement.addEventListener('click', () =>
        incrementDecrementRest('decreseRest', setTimeRest),
      )

      // start
      //cycle loop
      const cyclingFunction = () => {
        screenTime.style.color = 'green'
        if (cycleCount > 0) {
          cycleCount--

          let intervalID = setInterval(() => {
            cycleTime--
            screenTime.innerText = cycleTime
            if (cycleTime <= 0) {
              clearInterval(intervalID)
              time = roundedTime
              restTime = rounderRestTime
              roundCount = roundCounterStore
              startFunction()
            }
          }, 1000)
        }
      }
      // restTime loop
      const restartTimerFun = () => {
        screenTime.style.color = 'red'

        while (restTime > 0) {
          roundCount--
          console.log(roundCount)
          let intervalID = setInterval(() => {
            restTime--
            screenTime.innerText = restTime
            if (restTime === 0) {
              clearInterval(intervalID)
              //re running round function if roundCount is not 0

              restTime = rounderRestTime
              if (roundCount === 0) {
                cyclingFunction()
              } else {
                startFunction()
              }
            }
          }, 1000)
          break
        }
      }
      const startFunction = () => {
        screenTime.style.color = 'white'
        if (roundCount > 0) {
          while (time > 0) {
            console.log('ON')
            let internalID = setInterval(() => {
              if (time >= 1) {
                time--
                screenTime.innerText = time
              }

              if (time === 0) {
                //running restart after time is over
                restartTimerFun()
                clearInterval(internalID)
                time = roundedTime
              }
            }, 1000)
            break
          }
        }
      }

      start.addEventListener('click', () => startFunction())
    </script>
  </body>
</html>
